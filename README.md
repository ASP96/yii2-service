Yii2-service
==========

В состав входит возможность управлять (CRUD):

* Категории потребителей
* Услуги
* Цены за услуги для каждой категории потребителей
* Калькуляция оплаты работникам, основные отчеты

Также в моделу присутствует интерфейс заказа услуги для офлайн работы администратора предприятия.

![Автомойка](https://cloud.githubusercontent.com/assets/8104605/17052406/c0426774-5016-11e6-81af-75c8865a0639.png)

Установка
---------------------------------
Выполнить команду

```
php composer require pistol88/yii2-service "*"
```

Или добавить в composer.json

```
"pistol88/yii2-service": "*",
```

И выполнить

```
php composer update
```

Далее, мигрируем базу:

```
php yii migrate --migrationPath=vendor/pistol88/yii2-service/migrations
```

Модуль зависит от многих других модулей (смотрите composer.json). Не забудьте выполнить миграции каждого после устоновки.

Настройка
---------------------------------

В секцию modules конфига добавить:

```
    'modules' => [
        //..
        'service' => [
            'class' => 'pistol88\service\Module',
            'adminRoles' => ['administrator'],
            //Процент выручки, который делится между сотрудниками
            'workerPersent' => 30,
            //Массив сотрудников, которые занимаются реализацией услуг
            'workers' => function() {
                return \common\models\User::findAll(['status' => 2, 'id' => Yii::$app->authManager->getUserIdsByRole(['washer'])]);
            },
            'currency' => 'руб.', //
            'mainIdent' => 'Номер и марка автомобиля', //Наименование основного идентификатора услуги
            'mainIdentFieldSelector' => '#fieldvalue-value-2', //Селектор поля, куда будет вставляться mainIdent после ввода
        ],
        //..
    ]
```

Использование
---------------------------------
* ?r=service/index

Виджеты
---------------------------------
Виджеты в разработке.
